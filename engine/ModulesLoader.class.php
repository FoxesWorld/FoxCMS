<?php

	class ModulesLoader extends init {
		
		private $moduleIncOptionsFile = "incOptions.json";
		protected $db;
		protected $logger;
		
		function __construct($db, $logger) {
			$this->db = $db;
			$this->logger = $logger;
		}
		
			protected function modulesInc($path, $includePriority = "") {
				$modulesIncluded = array();
				$counter = 0;
				$modulePriority = "primary";
				$modulesArray = filesInDir::filesInDirArray($path);
				init::classUtil('CheckUserAccess', "1.0.0");
				foreach($modulesArray as $moduleName){
					$currentModuleDirectory = $path.DIRECTORY_SEPARATOR.$moduleName;
					$mainClassFile = $moduleName.'.class.php';
					$moduleIncOptFile = $currentModuleDirectory.DIRECTORY_SEPARATOR.$this->moduleIncOptionsFile;
					$moduleMainFilePath = $currentModuleDirectory.DIRECTORY_SEPARATOR.$mainClassFile;

					if(file_exists($moduleIncOptFile)) {
						$moduleIncOptFileContents = file::efile($moduleIncOptFile)["content"];
						$moduleIncOptFileArray = json_decode($moduleIncOptFileContents, true);
						foreach($moduleIncOptFileArray as $optionName => $optionValue) {
							$hasRights = true;
							switch($optionName){
								case "classInclude":
									switch($optionValue) {
										case true:
											$mainClassFile = $moduleIncOptFileArray["mainClass"];
											$moduleMainFilePath = $currentModuleDirectory.DIRECTORY_SEPARATOR.$mainClassFile;
										break;

										case false:
											unset($moduleMainFilePath);
										break;
									}
								break;
							

							case "priority":
								$modulePriority = $optionValue;
							break;
							
							case "userGroup":
								if(!CheckUserAccess::checkAccess(init::$usrArray['user_group'], $optionValue)){
									$hasRights = false;
								}
							break;
							}
						}
					}

					if(isset($moduleMainFilePath)) {
						if(file_exists($moduleMainFilePath)) {
						$moduleInfo = $this->readModuleInfo($moduleMainFilePath);
							$version = $moduleInfo["version"] ?? "unknown";
							$modulePicture = $moduleInfo["image"] ?? "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAABMWlDQ1BBZG9iZSBSR0IgKDE5OTgpAAAoz62OsUrDUBRAz4ui4lArBHFweJMoKLbqYMakLUUQrNUhydakoUppEl5e1X6Eo1sHF3e/wMlRcFD8Av9AcergECGDgwie6dzD5XLBqNh1p2GUYRBr1W460vV8OfvEDFMA0Amz1G61DgDiJI74wecrAuB50647Df7GfJgqDUyA7W6UhSAqQP9CpxrEGDCDfqpB3AGmOmnXQDwApV7uL0ApyP0NKCnX80F8AGbP9Xww5gAzyH0FMHV0qQFqSTpSZ71TLauWZUm7mwSRPB5lOhpkcj8OE5UmqqOjLpD/B8BivthuOnKtall76/wzrufL3N6PEIBYeixaQThU598qjJ3f5+LGeBkOb2F6UrTdK7jZgIXroq1WobwF9+MvwMZP/U6/OGUAAAAJcEhZcwAAD2EAAA9hAag/p2kAAAZmaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA2LjAtYzAwNiA3OS4xNjQ3NTMsIDIwMjEvMDIvMTUtMTE6NTI6MTMgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCAyMi4zIChXaW5kb3dzKSIgeG1wOkNyZWF0ZURhdGU9IjIwMjItMTAtMDJUMTI6NTM6NTUrMDM6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMjItMTAtMDJUMTI6NTM6NTUrMDM6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTEwLTAyVDEyOjUzOjU1KzAzOjAwIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOmVkYWEyZmRjLTRjYzEtOTI0Mi04ZWVhLTAwYjRiNzUwODdiYyIgeG1wTU06RG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjVlZmVkOTlhLWNkMWEtMjQ0Ny1hMTM0LTAzYjVmOTA2MDcwMiIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjlmNThkYWRmLTNiZGYtODI0My1hYWMwLTkzZTJmOTMxZTNmNiIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjlmNThkYWRmLTNiZGYtODI0My1hYWMwLTkzZTJmOTMxZTNmNiIgc3RFdnQ6d2hlbj0iMjAyMi0xMC0wMlQxMjo1Mzo1NSswMzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIyLjMgKFdpbmRvd3MpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDplZGFhMmZkYy00Y2MxLTkyNDItOGVlYS0wMGI0Yjc1MDg3YmMiIHN0RXZ0OndoZW49IjIwMjItMTAtMDJUMTI6NTM6NTUrMDM6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCAyMi4zIChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPHBob3Rvc2hvcDpEb2N1bWVudEFuY2VzdG9ycz4gPHJkZjpCYWc+IDxyZGY6bGk+YWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjhiZWM4ZjIzLTE5N2YtYjQ0Yy1hMjFkLTNhNGY2ZWExYzk1ZDwvcmRmOmxpPiA8L3JkZjpCYWc+IDwvcGhvdG9zaG9wOkRvY3VtZW50QW5jZXN0b3JzPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PpOSR20AACFTSURBVHjavZtprGXZddd/a+99zrnTm19Nr6q7uqvb3e2O7cQTHjo2dhASDiiJILEABSRmxCgiIYFAijBBBPEFYQFfICAIKKAIoqAMbbcdZ3ASz8FJt9s9VldXddWrN993hzPsvRYf9nllG+I4Dg5POnrvvnvuuWevvYb/+v/XEb4FPx/4wAd4/vnneeGFFwD4b//hv/DPPvnP+dy//QJi4ICBv8LqxWvucjOmUKemkZA85vxjurr+Tnf54nvDw1ff7S9tXzKEINDe3r+dPvW5H+f2nX/qx8N0evB8+HL3TJwT+Vb9hN/NSRsbGzjnODg4+G3fHw4HSNB7r3/iJ3+KxSsN67yTnZH3wyJoJVvm7zTajtNKKMbfoZtrT9jOufcUr7v/XYOHrmyE85u4Qghe8MDyuGYx3liNFy7/4/JXfvmd+sxzHzy/8u0LmU3C59pPRUjfEgPI7+akH/qhH2IymfChD33ot33/rU+8hd1XDti/dcR2tSPLunDX2EmTtU3MNeDC5eT923Vz7TvDg1e+s3zk6lvLq5eC2xxTjirEjG5e47uItR2zk47TkxoM/MoEa1rcL3zi4/alZ/5YUa4vrbvrf+34o6m1/08eICI45772UyOBbpWVpeP2p4/c5ujb3JWNMhYJ80NnWvjHUyF/wM7f/15/7f4nBtd2HqkeuMRga4UwCIgqGo3mdIZ1HYV3dE3k5HBJ2yRC4VA19HSKG03Q973/u1xKPylffun7RqOL3aXwbn8nfD41y/r33wBlVaBFl8OhusDSn7K1+gY36S7ZJe9MVFQcIxX3Rt1af4LL59/n79t5h7+6sz24co5ybUg5DDhRrG3ReU0SoU0eL1BWgdlpzfSoxcwoBgFRT4yRmJQ0n+NX1tD3f9d3dxp/Ql944Qce2Hx9Yhrcbvh1bazF0u9XCBTw8APXGPF6preP/NVyK8VOGGjAe73Qro7fahvr7+XC9nvk8s7bwn2XymJ7nTApCaXDmRJE8cFjHjrAe8fYCxPvuH0w5/h4iUVFo4IZSIGjIDY1qp7YtFiKuMkEZnPCxz/+n/2N539w3oylCTfkfy0/o1br748BHhxfdu18XUq208Obm7TJroXNrffoxvi96fyFJ9yVy4+6C+fw6xPcwBMCBDO8M6QQCB6CZzQouLBScX5tyGRcsTGseNu5AZ99cY8PP/klHMKk9MRooKBRURWK4QbtYkEzPULE4VdW0OmU8JGP/ljx6qt/oR2Lu3F0w15Z/Kb9XhLj1zXAZLVgPT5eXJs81PkaUlX+Ybmw/UH3yEPfzaWLO7a5iRtW4ME7CJbwwfBVAO+R4FgfBS5sjNjeGLO2OmQ4HuCqgpOYWERjZMqlScnhzUP+40d+E0WYFAUxKpoUSw6RQIqRrs5uLhiyMkEPjyifeupfhZu3/8YyVf5Li1/Tw3jjm06L8qY3velr/6PGKzfv8sbLf7Q4p77bfWVve/C6q//avePNPyCXd2BUoUnxgGjECajLphwOCtbXKrbWR2xujFldGzKYDKAqmCfjpEvUUXGmoMasiSyi8q4rG7C7z3948mkQx6gMaNd7QVJQJUYhRcW6iHMOWVlD794lfOTJfyF7R3/HpPV3Dr+kX7YXvikjyIc//OGv+YcF49//m//B9vzh8l1PPHzpY8/s/eT2n/7et/nJAF831LMFCiiCmlJ4x+pKxca5FTa2J0xWBwwnA7QsOI3GvI0IHk/E9z4XTWmj4kxIZpx2ibdfXsNuH/DjH30a8Z5xEbIndAZmaISujZgKpgCGW1lB7+wSnvy5H/X7J38/hI3w6wefSNPiJaMD7PcYApu8kT/08Hfw2Pe8/99cv/b4Xx1cWmV1esTucctx7RlUjsFAmKxWrG5PGK2PCeOK5D11NJoYETOCczgXEBRDMYGkUDmlcDBt8+JM4TQqb7+8Sntjl5/4hWcpypJBCKQuYQlMjdhGUgJM0KgI4FZXsduv4Z/82R/m6PhDM7dZnIb/FZ87+A2z7hsbwK8Bg686GmCbh1kcLovyoQf+yTu+593nt+OC1EbuJsf5nXWuXDvHhWvnWbu8iVsZMjfhdNHRNJHUJkgGqhiC+IKurlksO5bLxHTeMRQYOZglEMmJvxB4Zdpy+fIWr98Y8cXnd8F5iuDyjguIOCwlzBQRBybQtsjWNrZ97v1y62Y96ea/JHK+mNdHWqfTb+wB//qrXiwFPv4HP8i73vMnxs3h/vfur2z9+Pf/2ffJKi2fP0nMywFaemad0XRGFxOxi4gLKIJZzAtCiGrEJGgyNAkxdYDivANnpKQMBo61lQozQw3MHEvxvPnChNPnrvPTv/4KVVVSACkpKMQuf6clAxVMDQkOt7KKvXyd8NRTf9ufnvzLu10o7+pn21l5g9Oj38EDPgF8tD+eAt7+rvfLt115vT/R9JfD1Qff/voHN7h4fkAdBpCUZtkxXyaapiNGxcwglCTz1POGemnM54nFPNI2QupANRtGBJwAOEQ8sYMYlUEZEBMcgk+RV6c1V65s8cDQ8ezLB+AcpXOg5AsYiAlCviZqEDvczg66uvEBu3nzTol+esddLab1sZ7G6dc3QEcGJx0Qqdh/Zumee+rp7su3Z39l+4m3PXruvnVmCXanLc+fJGYdqCoqBW2r1MvE/KRmdrRgMU+0jSdFRQS8CGiHQxGzPuEIporg8M7RtYmUhEEVsKSICcHg1ixy+fImVwrjhVcOcT7gXU5aQjaWoDgRRHJycSnhdi6gk8kfCzdvXK+b9vMVO+Vxe5Aii9/eAF/T1cl5Hh6/zYoiPrbxjrf+48ff86aBrZTsLpQKoU1KisZ0Hjk9TcyOG5YLo61Bk+Ak4CzmmzQFjTkTm0M0p2RLPV5Rg6QIQtcqKSrVwPfnG8Hg9iJx+com573y0iuH+DLgxfKu9wZ1ks3qBIgRSRG/s0Majr9Pbr787Nj5L24Xj5YncZoajn9nA4yZcDHsUG6tfs/6W9/8wZWHr+AnBYtlok0w8YrrItdfa1jMmrwTIrizhkkESTGDFTMQwTmfsxxC7POBaA4Ds5zRnQhtHdFklJWAghh4M3YXiZ3Lm2y7xI1bU3wIeCRfXw2RHAqO/Ldp9gR/5TIyGH1/98oLv7FSxWeGo4eq1vbTojv9+gbYGT3sLq5sWbF98W/Jw49+x+jSGtW4pF22RBP2TyO3j2tSC9oJLgQsGpYUNEFK+DCAlFDLu3sWrzEZk1IoBCKjbBRNgANVnHO0raFRKcuAmQM1nBoHtXLpyjbrmnj15hFlGQjO5WuY3duAbIwcDqKKu+8+fDn44OLl658Zsnh2g2tlLBZpFo/vYYR7BnCsslO+jVHgnL9y3z/y165tnn9gEyEjsBSVo+OG2EWKwmfI2kZiTDhTHA7BQYqg2u+igLk+YxuFy67fdkqGerlcalJMDSfQNYapUZbS5wTwCkcNXNhZZxJb7uyeUFQhe5wp4rIX5bCwezlBNJm7csW5ED6oL9/4FQr34hqXqmV6LbWhQdNXGWBr/BBX/SYuhPdx7dG/ufbog5y/ska7aHF46rpjMe/d3jmqyrGYJbQzpDcACpa6ezuC9UVeI8GXRMY0TcKlBlPNxjGywVJuggRHu0ygRlV6iCnTakmZxuwJ1WLB3b0pZVXiJHsKGM77DJPNwBS6TpwI/v77vbriB+zGC79Yanh5JBer293dZNrgn3jiCXwQZrXKfe4y5fbGX+TBR5/YemSHtc0xXR1xTljMO9om4XFoUpou4sQRa0OT4sT6WPc5NulvRFMfCh7nS4gtFtvsLZruZX7pP4cqDqPr29vBoMweZDkc5gkuXNkmLJYcHpxSVCWY9jvvEKN/3e9tF3NSvXK5QIo/kW69+JGqXLt5Z+nKla0y+SeffJLSF3z6I7/ptoeXq8F9l3/YP/jQlQvXtinKghQTpsZy3kLKWddZTlJOlNIbpQhRBZFwL/M7k5yYzO55hjazHJvi801ajllJCTS/zr/B4WgX2ZsGVQAVxEBSosGxvbOFnc45OTylKAPOwCz1YdAnSQNTRZsGwIr7HhholD/ubr/yM+OivLPpdorw+OOPMyq3ePuF79Kg+oY4XHvLyvqE0aikm9fk6mKkOuK8z4sBxAwFRkOPeWNxFPGhDwcRJNAvPBGKgDjXx75hLp1xbdmSBoaB9Gyvc4gXvBnzwyXOhNE4oMkQMXSx5FQrLr/pYTQ9z/7eCcWoQjRgpB6n5HIpThBz6LJBDRu+6w+cq2P75MYXvvjEtKtvOIAtvV+0NaSq3iWTtXKyNqQoA0QliCe1CW0jEhWL2v82XFSWs45l21FJLpEBQVSz6yVDpGTohc1hAdGQBBINl6yv2+BkgHeDjA9iwqJClxDNwGd2tKSetXgMkuFwWN1SJ7jy7a9jbWOVbtngnccBzgzXh4MXx3C4QgiFsGjQprXhO955xT360H8v1QoPcGm441ZYs9HFS3+3uHrt8XMPXWQwGtwjIJbTBo1yL9lJX7rgLBTAecutq55trsMBwQdi07JYdPmz2qNCM0QNL0V2/ZRwqjg8opbP63EGGLFWghOKwuc8IQ5rO3xZsrK9yWzvkFjP+56evmnKVSfFmOk2RdJiaVaWEjbP7+jua0vvGXHJPWwbq5MHwqX7f2TwwNXxpWsXkN59NSrNPPf0YglnLndjfQ1GFVFwTvBOaJcR1PAiWFSsrXuurwdKmnBS3jMEGiG2GUD1OeEM5YlZziUiODO6VhERgqP3DkdsWy5sVFxeH1DPW3xRMKgCZeGoCk8ZHEWAqhC8s6w7qJpfmYgsmnNhWKyyOT6HuvBOG66cn2xMqIpAs2jwHtpFRBvFBwPxaGxwAC5gZvSAL3dl4rh4bkQ9qzltPEUxILaZyxNVSAkJBZI6xBI4n3fprHZrBlTJcn5wPl8XzV2UmHBx5EjBMW8SwSk4wVlCzyqNkQGWOdQM7wLOO1JqCF+Vw6wo0PGwDOflnGtZ6mh06TvDyiorK4N8kdgRylXEOqzbR6TAxOGlABNSPIO80vfqoETQgHcB2gaziFPL2+V8dvuU22cRn+muHjOckTdJjeEgaxBNNHzIMNchBOcz7PWG9+BzzWNaK7deOuTw7hQJjtR1pJiyrqA5JNQMEY9gmPNICbpslmFNdkxEV4r1jfcO1taYjAdY0+IVrE2kZUOQgFNBtcNXa+A8dMcgguYeFczhRZhNa7wPDAqjaxa4EHJe0IwnzlwX5ymcoBZJqQMxxDlEjHHpMBGSKd5lhOgELHbsTR2jcZkXYkJRFrSnNYuDKZJiBlgp5xfX5xpTzjzMMu2ZkBiJJyevhVSIDYvJW9149Y3jtRHj0YB22RJ8QaxruvkphS/QqHjx0Mx7RSWXlyQZuppFzKAqJ7gQcHqKdR7trOcAcllyhcPjMBmxuS6INewddvjQq09mLOYtOEflHBYTOEGBUDoGAaRTcJYdqyqY3z1heXiS24qkIHKPL1ATxGXiRFMH4nFl5UK9pDvY/1RYLUvKQfWEH0xYWRtTBE9UcE5ZLpZ4Be9SDgscal8RIAwIkpOiYlnVcQXOVQhzfCXU81y7fXA5mTlwwSEyp57la5TuLNYT1oMnR58gneB6Vy4GniBljxgTOEhNx/TuMbFpcUHOuLN7lFl2ekFcIOHo2o5iFIiv3tH2+OBngybDT9beO1hZZTwekOoW6xqMAdp4tJmDFpkx1xbEgThijIgD7/IX9N05TbOH4VAVQqGMJ47lTCFlkURjJMUpYJgV2fWJqAhqBgLeh2xUM8SB9j2/F0WbFstNA6EsqI+XzPeOc2KOivhMleTk/BX6BM3YoyhKfFJmt175pLTd50MoeKQcrb17srnKaFAS5w1OoZvXNLMa0aznGRnfG4oZTAYFbRNZNm0mK7OTZ5YXUBVkUlAOIASo5y3iW8DwxQiziOoyGyJjS1QTRTUCCtpmmjfTZRooBId1nmVa5KriHIjn5PYhzckMV+R7yNSb5N89UyIYUZNZMnw1EKYn6MHRzyyDWhgMV5/ww9XJ5voak0HJdDqjCB4RGPhMr2sv2ZkmtO/vfZVBj9fQE6EZ3poIZkZwwqDwSDSGlcMlqBcdzgtOI2hELPXZX8Bl1CYx64DewMwypW5QVCUej3YRcZo9o+5YHJxgMWLiEe9zknUZwDlyaKW+3RaEwgXqg7tNPTt6MiWP89X4iXMXL/H4685RiOHM0S4jF9aGXFyf0M47rI3QJCQJPgEpcXpSE5uWwXCVIlRIvyBvisRcoz0J6xIkYTAsKAuBaGh9CinielyZm5xMYuTuMSdOj/Xo0CiD4FXu4QkvQjudsTg4zuCp5x+kxwHu7O9OISouac4/XWR56+YvRl3+hl9OnQuD1Xdvb6/zrrecZ6V0GfV1ysnxjOn0FKfgDRyK07zAAJTiKXBYfQzdkgJHQCBGhqXnwuYQb4ZXQ2KDS8pkMqD0RjBHMMEnI6hQ0AuqmvJ39bSW05zpC8mNkXUtLvWx7ITl4ZT2dNbDas3vKTgVRA3tO1mxvGkhFJJODmn293/Wp5Kj6sDcyvrmld2DA37+f3wB3wgeIwDNMuGcZ1QGJFnPw2nuB0xB28wEaewNQ14QDqdCbBISU7a8gksgydjeGnF+c0TqOkS7rC9qzBDZwGvE9SHgLOFSogwud/dRe0+x7P77x3mBmmU21xvB9wsm9g2VqmHZu7v9Owva+qMncUG7Ojc3Gg0EVX7qpz7Ja8++xP3n12nqjoBnGAZMRiWeDCwC2RsKV1Dg8ap4NTyKA7xzvaESXRvzjphmNJg66FpSm+hizKFihtOEpHxOQAji8X1H583jUEoneM0LEBMK56inMxbHU4LPjLPDIebANDdCbcJpNgpRMyTuWurd20913eKZoVT+1Vs3cE5w3XyJSOKTv/QZ3OmUc5trdE0DSSmCz0ZQxZsRrI/L/vBAsDxqEhB86iidUorl95DszinhVYl1CymyMgr4lFmePEQBXrKBvQleFdFIGRzBeSxGJLV4UwofWB5NifNlH575fNczxdamnBNUsZS9K3gv6fiQ+f7e/0Qdt9JLihS42eHhbtd0rI2HTE/nfPJjv8rFYWBQFLSLBXTKsCwZDarsXgguRZwlvPQdmzicJSQ2BBeoigKH4S0vzlsODY9kL1JHVQQGJfnmJJOTntxFevrPqVKK9MYzQn/NVNfM949zEu0VpTOdwbrYh4Qimak21BgUK8Sjw2NtFx8/bZPs8YIhDe7k7s3/VMRIVQ7ZXFvluRde5bc+/TkeOL9GukdcGFWRhUoxJUh2wyAu37Qqla/wktWbqigJBLxIPkdczxz3FDbZTcejggtbYwpxeINgLu9kavAGlauyAVTx5iAZVVHRnMxZHk0JXnoCBJySYXOynrLLiNIbeOehWVAf3H3KWXhprnckE6/gjqcHPzLdffELo6KkLCs21lf41V/9Ioc3XuXBy5ssFzWkiFcYV1V2acuNRiBn6FIMYkvljY2VAYUIwfKRq0Pe3WB5F3PICN483gWCGBI7Qp/tPY4gHrGGwnlKNyBQIF0LMTLfP8baltCLMl4VS10uj2d8ZbKcNNWkLEupD15jun/nf3bWcdrV9yYHXBu0OznY+zPLo93lqBowrCpCEXjy5z6BX845v7lGu2xAMz1WlUV2Me0tTJbETDuCwKj0WNfkDE7G7A4hSCC4MlcE01wtpCB2ieGgoPRf+VzhKoJkMkPMsLjE0pIgnm6xZH50TPAebw6nZEo95ZxT9AbJemSfaJNSH+ztWlt/bNY6uauHXzFAXGpxtOie3r/78t+iXjAoB6yPhxyfzvjEU7/EfdsjhmVFals0tlROKEMmHkLvfqRI5UeYeubzFi8hgyK1nNB6SjtXjL5SqN5jgoKD8XiQ3zOHJ+FTTSm+D4mES5HCO5rpjHa2oPC5zcmagvbVh55OyyjV9UMa0tbUxwdPqsqtRddIkq/IYz6sztQPVorQlZ/VdvHQ5vqFbzfnGZSe66/covLGm974KLt3T7KrGgTfc4JnNBf5C4dloCwEi4nc9PYK7plYailTXb0KJJYYhDJXAucogqdr2zxdEjyF973IklFeGQoOb+8yn55SFkWmv1V7mVzwZ/dyJpaaUZQDutMjDl596Uebuv2t64tftpqvGMDdnN5BJ6exkAGHR/t//Xj/5gujoqQqKs5vbfGLv/gZbt+4ziMP7uSGpo/9qiiyu4qnDBXOWrxLecexHjtkjj8nJMHjsicgFOIJOGLbYClB7CgDjAYFkqCQnDscGR8U3hPrjuXJjCC9YVKvGllOxK5HfR7L2IIssM72d19dnM4+XgbvYjH7P8TRBPPFCUdT8zsbV+rF4viz43L450ajVXECSZWXnr/OW9/8GFU55OTolMK7jNXF0JQQSwTnKKsiE5q9xO1F8D0x4SQzRq7/2zTlGBWynNXreWXwXLvvPE5gsagpXDZcKDyzo2Om+3OKckiKbf4eoRdC5F5TLr1OGEKA2LH/yov/tV7M/+uR35fbqTSNq8AGsJHb6GU9Z+2NTbrLtKzn8ddu713/u3QNg2rIufU1lvMlT/38J7jvyjqT0YDUdjg1Cl9QeEes882UPucGL47gQq/09PS3kuu0Jix2iKae+JAeTBlFX17NIsSU/y8Op0oBWN3gLAfXWVkNZ8BJpM8hfCVB+0CcTWmXpz/XFh235CXV5irw+nuHpx9dHQTPq7s30/ZgOxh8Utv2LZsr24867xiNBrxy/TYr44pvf/Nj3Ll5hA+ZBheDtY0J6+vjLKRKlsW88xmMYDh3j5f5Kmzg8eIJPjNFZSgYlEOMyHLe9vRKn9gQSuc53jvkZHqEpTZji94FnGQYnof3BJEMjYsQ2L91/fnp4Z1/0EjZvnjwjJk9Czx/73D0A0i3bt6mSbtcnz+XUiMcnhz+pYOD124NQ8WwGHD5wgV+7Rc+z9HBPm940wPERUfhskuvjCtWx8OM9EQITnCaKHyg8iEjuDOEp9ZLK712qIpXwZtDY5e7P+covGdYFRCVgoBPiflJDr/CuYw+s0aUIXCKuQJkCpjgA1bXnB7t/0xHefziwXPA7BtPix+m2xbt2wqXyruvHd7485PRypMrkw1KCaQm8vGf/iR/+q99L1evXmT/zhHjccXieEE77xhUBSkpqkpSPVOte+o8D0s4cfe0QOm5ICeZdVEyc2xJiTHPxq2MRuxc3eCF33qJ5WxJNShIvfBJT6dbT5ufKUGGEZxndrzPPM4/MmtOuG+n0ve/8/syg/07GWAwgdvFs92kvVRc4NJHbtx++UceuTr8h1U5YHN9hb3dQ3715z/FH/lT30X7yw1d2zFaGaGmdF2e4dOvUn3OBCTrGR6TgFnCLGVjOCH5CB6C9xQhUFUF5SBQlAVXHltn7VzB5z5xmuNaHGA9OZuTnf8qgSWXQI9TZXay/0zq+JWTeEcunff2zne++3c/LH1peJlL5dv8qPTpwmT7Fx67+ob3QaLtWqb7M777B/8gj7zlEZ792A38MNDGjq7p6FJCU2aI+/SP80IIRRZcRSmKCnGZAxSygutcv5M+f04tYSQWiyUHr01pa+V0NuN0Nsf5gGEky6qHk4CaYWJgQigLUmz58pc+96Ons+O/f3d+JF9uf8m+qQcmduMtVst1q+wxdk/2/tz6wc3P33/+gQ0BVjZGfOqnv8jl113kzT/4IIfPzfI8IIZqVpAzu6V0baRrI6lV2qZjsVwyn51SL2vm8zltm8duUkp5FLZT2q7Lc8Gxl968sLa1yvrWBmbG9OQUX/iekj+bQ8zl1lAKP+T0cJ96ufi5zsGdas+GYYz8NsPDX9cAGuGFk6f1sdWt4v6VK9df3Hv5r0yq8X87t3ke7xztSctvfeR5PvDu97DadBy8OGV2Muf08JTpyZzZ6ZLF6ZLFvGExr1kuatqmo21b2rYmpoT1k2XeebwPFCEQQsB5oSyGSEXO6CLUiwWHMbG2uYFqYnqcjeB8uDc7SD/AjSrz2dFnk7WffuXoprvy+Io++MD7f28PTGxXW7xh9Ymyrl27tbb64Tdf+46/MR4OUY0UVnL1oQdZ1nNuvnSL+XLBbLmgiS2dJlQUcQ4fynyjWblExHrGt9frXBYynMtgScQRQtGDnH4aVByqShlKzp8/x2w55+7efh6g9Flqw+jdv+O5F7/wocPj5oefnV13B/ZpdV9nqf4bGWChSw7ndbpaPuQWrv5YUy8/cGHt3E4RCtSUerGgS5FZPaOTSPIpu2fpKMpAUXiqcsjacL1fkOYddy5jBe8IzhF8IDhP8AHvQ1aTJJe7szkBcVnpoVOqUclwOGJ2ekpKKeuOZOHj+GjPbu69/Pd8Wr/14vJ5i7bXK9n/9/GNH5oyWL9qHPupyIE1u273z97YW/vsAxceGKaUaFPHSPJuaU9pi/RjMmclR6BNdR6YcPlBqbPylUfcsjGkh8RO/Fck87NRmp5IEYFZO4O9OWsbG1y6dJHdO7t0dcNgOESTcjTd/1hM/jO782fcG96yrqtr7//6s8K/m6cqrj18lVjdsvlSi43u/O5Rc3JnUoy/Z1QOWNY1RZkfa2napl9AzwI5T/AFQQQj4UQonL833+ud78/1fQRzb2bobO1O3BmE6DvDgHMBTKkXS8qqZHNzg/linqdRY8udg1f/aTrVz73UfJZqUxHzfe75vw/5Zh4vGQwv8mjxlmJlUHVbw83/+IbLj/wZB4xWxoBweHx0b9cyJBXoF6emvQCUA9uQfpFnkls/TC0ZHkmf4TNU8BlbnBnC+XvZS81YXVtlNBxzcHTCcy8/vfvq3kuvb8vVk988/pQu6xd/5wcmvhkDxDijcit2qdqSw2b+lCDfvzFa28KUoiiomxrBMrXt+p2znPSCD7l763VAdzZfhNwDN2ejrr6vDsF7gsvgqAg5P5RFQQgFIQS89wTv6ZqWJna8dvDarVfvPP8nRcOXX14cuqPu6fyszf/rg5Nf/XPUPW23Fj5sje87vXV8+wfHxfBTlzfP54YlFLRtm2cls4iYN0oNtdSDlgx66Mflne87A7k3C39mHlQTakbbtCRTOot0MZJiN48aT7sYD+q22U+p2zs5nX7xMLb/ZeQHL95srhevLT7fYc235tnh/9NnfPA8VLy9vFJdbaXgzz988aF/99ClBwgoh0dH/ciqp9/YLHP3bn4vPBx0KRFTRMWIKdF2zbKz7iglndZtt1enej913V4XdV+t3Y8x7ZvYgeIOk6ajKHYSEtO2WS7aNmGjOcvTVNx2L8cTXjNtv0WPzn7NT4KUEi/r0+16eaEYqvzYs68915rIhy5uXthS70imxK4jxthD1tS1XTdV02kbm+NFU9/pNO2rpMPYxb2kehBFj1PX7mmKhynIqanOtNaFFuC90ZohmsXVQdmhrbCMDVLUmCvl+eZZC80BM7T7Zh6u/99rMoKTMUEemQAAAABJRU5ErkJggg==";
							$description = $moduleInfo["description"] ?? "No description";
							$modulesIncluded["modulesArray"][] = array(
								"moduleName" => $moduleName,
								"modulePicture" => $modulePicture,
								"version" => $version,
								"description" => $description,
								"moduleMainClass" => $mainClassFile,
								"modulePriority" => $modulePriority
							);
							if($hasRights === true) {
								if(isset($modulePriority)) {
									if($modulePriority === $includePriority) {
										require_once($moduleMainFilePath);
									}
								} else {
									require_once($moduleMainFilePath);
								}
							$counter++;
							}
						}
					}
				}
				$modulesIncluded["modulesammount"] = $counter;

				return $modulesIncluded;
			}
			
			private function readModuleInfo($path) {
				$decodedOptions = "";
				$moduleContents = file::efile($path)["content"];
				$moduleInfo = functions::getStrBetween($moduleContents, "/*FoxesModule%>","<%FoxesModule*/");
				if(count($moduleInfo) > 0) {
					$decodedOptions = json_decode($moduleInfo[0], true);
				}
				
				return $decodedOptions;
			}
		}